{% extends 'base.html' %}
{% block titre_page %}Catalogue{% endblock %}
{% load static %}

{% block entete %}
<header class="page-header page-header-dark bg-gradient-primary-to-secondary">
    <div class="page-header-content">
        <div class="container text-center">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <h1 class="page-header-title mb-3">Tableau de bord</h1>
                    <p class="page-header-text text-dark">Le parc immobilier de la Fédération Wallonie-Bruxelles<br>Situation au {% now "l j F Y" %}</p>
                </div>
            </div>
        </div>
    </div>
        <div class="svg-border-waves text-white">
            <!-- Wave SVG Border-->
            <svg class="wave" style="pointer-events: none" fill="currentColor" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1920 75">
            <defs>
                <style>
                    .a {
                        fill: none;
                    }
                    .b {
                        clip-path: url(#a);
                    }
                    .d {
                        opacity: 0.5;
                        isolation: isolate;
                    }
                </style>
            </defs>
            <clipPath id="a"><rect class="a" width="1920" height="75"></rect></clipPath>
            <g class="b"><path class="c" d="M1963,327H-105V65A2647.49,2647.49,0,0,1,431,19c217.7,3.5,239.6,30.8,470,36,297.3,6.7,367.5-36.2,642-28a2511.41,2511.41,0,0,1,420,48"></path></g>
            <g class="b"><path class="d" d="M-127,404H1963V44c-140.1-28-343.3-46.7-566,22-75.5,23.3-118.5,45.9-162,64-48.6,20.2-404.7,128-784,0C355.2,97.7,341.6,78.3,235,50,86.6,10.6-41.8,6.9-127,10"></path></g>
            <g class="b"><path class="d" d="M1979,462-155,446V106C251.8,20.2,576.6,15.9,805,30c167.4,10.3,322.3,32.9,680,56,207,13.4,378,20.3,494,24"></path></g>
            <g class="b"><path class="d" d="M1998,484H-243V100c445.8,26.8,794.2-4.1,1035-39,141-20.4,231.1-40.1,378-45,349.6-11.6,636.7,73.8,828,150"></path></g>
          </svg>
        </div>
</header>
{% endblock %}

{% block contenu %}

    <div class="container-fluid">
        <div class="row gx-4 justify-content-center pt-5">
            <div class="col-lg-4">
                <p><a href="{% url 'catalogue:orga-list' %}">Liste des organisations</a></p>
            </div>
            <div class="col-xxl-8 col-xl-6 mb-4">
                <div class="card-body">
                    <div id="map" style="height:400px;width:100%;"></div>
                </div>
            </div>
        </div>
    </div>
  
{% endblock %}


{% block js_page %}
{% load l10n %}
<script type="text/javascript">
var map = L.map('map').setView([50.534, 4.400], 8);
var osm = L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
  attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
});
map.addLayer(osm);

var markers = L.markerClusterGroup();

{% for site in adresses %}
  markers.addLayer(L.marker([{{site.latitude|unlocalize}}, {{site.longitude|unlocalize}}]).bindPopup('<a href="{{ site.get_absolute_url }}">{{ site }}</a>'));
{% endfor %}

map.addLayer(markers);

var osmGeocoder = new L.Control.OSMGeocoder({
  placeholder: 'Chercher un lieu...',
  collapsed: false,
  text:"Hop !"
});

map.addControl(osmGeocoder);
map.addControl(new L.Control.Fullscreen());
</script>
<script type="text/javascript"> $("a[href='#geoloc']").on('shown.bs.tab', function(e) {
      map.invalidateSize();
 });</script>
{% endblock %}